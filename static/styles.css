/* ================================
   Lore Leaf Knowledge Bot Styles
   Dark, cozy, crisp interactions
   ================================ */

/* ---------- Variables ---------- */
:root {
  --bg: #0f1412;
  --bg-card: #161d1b;
  --bg-subtle: #1b2321;
  --bg-alt: #121816;

  --fg: #e8f1ed;
  --muted: #a3b5ae;

  --line: #2a3431;
  --accent: #9bd4be;
  --accent-weak: rgba(155, 212, 190, 0.25);
  --ring: rgba(155, 212, 190, 0.35);

  --error: #ff7676;
  --success: #7fc5b0;

  --radius: 12px;
  --radius-lg: 14px;

  --font-sans: "Inter", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  --font-title: "Fraunces", ui-serif, Georgia, serif;
}

/* ---------- Reset ---------- */
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; }
body {
  font-family: var(--font-sans);
  background: linear-gradient(180deg, var(--bg-alt) 0%, var(--bg) 100%);
  color: var(--fg);
  line-height: 1.55;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}
img { max-width: 100%; display: block; }
a { color: var(--accent); text-decoration: none; }
a:hover { text-decoration: underline; }

/* ---------- App Layout ---------- */
.app {
  display: grid;
  grid-template-columns: 280px 1fr 360px;
  min-height: 100vh;
}

.side {
  padding: 1rem;
  border-right: 1px solid var(--line);
  background: #0f1412; /* a touch darker for separation */
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.main {
  padding: 1rem;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.preview {
  border-left: 1px solid var(--line);
  background: #0e1412;
  padding: 1rem;
}

/* Responsive */
@media (max-width: 1200px) {
  .app { grid-template-columns: 260px 1fr 0; }
  .preview { display: none; }
}
@media (max-width: 820px) {
  .app { grid-template-columns: 1fr; }
  .side { order: 1; border-right: none; border-top: 1px solid var(--line); }
  .main { order: 0; }
  .preview { display: none; }
}

/* ---------- Cards & Surfaces ---------- */
.card {
  background: var(--bg-card);
  border: 1px solid var(--line);
  border-radius: var(--radius-lg);
  padding: 1rem;
  box-shadow: 0 6px 24px rgba(0,0,0,0.25);
  position: relative;
}
.card-subtle { background: var(--bg-subtle); }

.panel {
  background: var(--bg-card);
  border: 1px solid var(--line);
  border-radius: var(--radius);
  padding: .85rem;
}
.panel.tiny { padding: .65rem; }

.panel-h {
  font-weight: 600;
  margin-bottom: .5rem;
  color: #dbe7e2;
}

/* Reveal-on-scroll */
.reveal { opacity: 0; transform: translateY(6px); transition: opacity .35s ease, transform .35s ease; }
.reveal.show { opacity: 1; transform: none; }

/* ---------- Brand / Hero ---------- */
.brand-mini { display:flex; align-items:center; gap:.5rem; }
.logo { font-size: 1.15rem; }
.title {
  font-family: var(--font-title);
  font-size: 1.6rem;
  letter-spacing: .2px;
}
.hero { display:flex; justify-content:space-between; align-items:flex-start; gap:1rem; }
.hero .title { margin:.15rem 0; }
.hero .muted { color: var(--muted); }

/* Cozy glow */
.hero::before {
  content:"";
  position:absolute;
  inset:-2px;
  background: radial-gradient(260px 140px at 8% 8%, rgba(155,212,190,.12), transparent 60%);
  filter: blur(18px);
  z-index:-1;
  border-radius: inherit;
}

/* ---------- Text utils ---------- */
.muted { color: var(--muted); }

/* ---------- Controls ---------- */
.controls { display:flex; align-items:center; gap:.75rem; }

/* Buttons */
.btn {
  padding: 0.55rem .95rem;
  border-radius: var(--radius);
  font: inherit;
  cursor: pointer;
  background: var(--accent);
  color: #0b1411;
  border: 1px solid transparent;
  font-weight: 600;
  position: relative;
  overflow: hidden;
  transition: transform .08s ease, box-shadow .2s ease, background .2s ease;
}
.btn:hover { transform: translateY(-1px); box-shadow: 0 8px 20px rgba(0,0,0,.28); }
.btn:active { transform: translateY(0); box-shadow: 0 3px 10px rgba(0,0,0,.22); }

.btn-secondary {
  background: var(--bg-subtle);
  color: var(--fg);
  border: 1px solid var(--line);
}
.btn-ghost {
  background: transparent;
  color: var(--fg);
  border: 1px solid var(--line);
}
.btn-block { width: 100%; }

/* Ripple */
.btn.rippling::after {
  content:"";
  position:absolute; inset:0;
  background: radial-gradient(circle at var(--x) var(--y), rgba(255,255,255,.35), transparent 40%);
  animation: ripple .5s ease-out;
}
@keyframes ripple { from{opacity:.6} to{opacity:0} }

/* Status pill */
.pill {
  font-size: .85rem;
  padding: .25rem .7rem;
  border-radius: 999px;
  border: 1px solid var(--line);
  min-width: 70px;
  text-align: center;
  background: var(--bg-subtle);
  color: var(--muted);
}
.pill-good { border-color: var(--success); color:#10332a; background: var(--success); }
.pill-bad  { border-color: var(--error);   color:#300b0b; background: var(--error); }

/* ---------- Inputs ---------- */
.input, .select {
  padding: .6rem .75rem;
  border-radius: var(--radius);
  border: 1px solid var(--line);
  background: var(--bg-subtle);
  color: var(--fg);
  font: inherit;
  transition: box-shadow .2s ease, border-color .2s ease, background .2s ease;
}
.input:focus, .select:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 4px var(--ring), 0 10px 22px rgba(0,0,0,.25);
}

/* ---------- Ask Row ---------- */
.ask-row {
  display: grid;
  grid-template-columns: 1fr auto auto;
  gap: .6rem;
  align-items: center;
}

/* ---------- Tabs ---------- */
.tabs { display:flex; gap:.5rem; border-bottom:1px solid var(--line); }
.tab {
  background: transparent;
  border: none;
  color: var(--muted);
  padding: .6rem .9rem;
  cursor: pointer;
  border-bottom: 2px solid transparent;
}
.tab:hover { color: #dfe9e5; }
.tab.active { color: #eaf4f0; border-bottom-color: var(--accent); font-weight: 600; }

.tabpane { display:none; padding: .85rem .2rem; }
.tabpane.active { display:block; }

/* ---------- Answer & Sources ---------- */
.answer {
  margin-top: .25rem;
  padding: 1rem;
  font-size: 1rem;
  background: var(--bg-subtle);
  border: 1px solid var(--line);
  border-radius: var(--radius);
  opacity: 0;
  transition: opacity .35s ease;
}
.answer.show { opacity: 1; }

.answer-actions { display:flex; gap:.5rem; justify-content:flex-end; margin-top:.6rem; }

.sources { margin-top: .5rem; font-size: .92rem; color: var(--muted); }
.sources .src-item {
  width: 100%;
  text-align: left;
  color: inherit;
  display: block;
  padding: .55rem .6rem;
  border: 1px solid var(--line);
  border-radius: 10px;
  background: #111816;
  margin: .35rem 0;
  cursor: pointer;
  transition: background .18s ease, border-color .18s ease;
}
.sources .src-item:hover { background: #16201d; border-color: #36433f; }
.sources .src-item strong { color: var(--accent); }

/* ---------- Chunks ---------- */
.chunks { padding-left: 1.1rem; display: grid; gap: .25rem; }
.chunks li { color: var(--muted); }

/* ---------- Sidebar Bits ---------- */
.onboard p { margin-bottom: .4rem; }
.history { list-style:none; padding:0; margin:0; display:grid; gap:.4rem; }
.chip {
  border: 1px solid var(--line);
  background: transparent;
  color: var(--fg);
  border-radius: 999px;
  padding: .35rem .6rem;
  font-size: .85rem;
  cursor: pointer;
  transition: background .2s ease, border-color .2s ease;
}
.chip:hover { background: #12201c; border-color: #3c4a46; }

.persona-chips {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: .4rem;
}
.persona-chips label {
  display:flex; align-items:center; gap:.45rem;
  background: var(--bg-subtle);
  border: 1px solid var(--line);
  padding: .45rem .6rem;
  border-radius: 10px;
  cursor: pointer;
}
.persona-chips input { accent-color: var(--accent); }

/* Metrics */
.metric { display:flex; justify-content:space-between; font-size:.92rem; margin:.2rem 0; color:#d2dfd9; }
.metric b { color:#f0fbf6; font-weight:700; }

/* ---------- Dropzone ---------- */
.dropzone {
  border: 2px dashed var(--line);
  border-radius: 12px;
  padding: 1rem;
  text-align: center;
  color: var(--muted);
  background: #0f1614;
  transition: background .2s ease, border-color .2s ease, color .2s ease;
}
.dropzone.drag {
  border-color: var(--accent);
  background: rgba(155,212,190, .08);
  color: #e8f1ed;
}

/* ---------- Preview Rail ---------- */
#preview .panel { height: 100%; display:flex; flex-direction:column; }
#preview .panel-h { margin-bottom: .6rem; }
#previewBody {
  overflow: auto;
  white-space: normal;
  flex: 1;
  background: #0f1614;
  border: 1px solid var(--line);
  border-radius: 10px;
  padding: .8rem;
}

/* ---------- Dialog (Settings Drawer) ---------- */
dialog::backdrop { background: rgba(0,0,0,.35); }
dialog {
  border: none;
  padding: 0;
  background: transparent;
}
.sheet {
  min-width: 340px;
  background: var(--bg-card);
  border: 1px solid var(--line);
  border-radius: 14px;
  padding: 1rem;
  display: grid;
  gap: .8rem;
  box-shadow: 0 20px 60px rgba(0,0,0,.5);
}
.sheet h3 { margin-bottom: .2rem; }
.sheet label { display:grid; gap:.35rem; font-size:.95rem; color:#dbe7e2; }
.sheet menu { display:flex; gap:.5rem; justify-content:flex-end; }

/* ---------- Status / Animations ---------- */
.pill[data-state="idle"] { background: var(--bg-subtle); color: var(--muted); }
.pill[data-state="indexing"] {
  background: linear-gradient(90deg, #0c1010 0%, #14201d 50%, #0c1010 100%);
  background-size: 240% 100%;
  animation: shimmer 1.4s ease-in-out infinite;
  color: var(--accent);
  border-color: var(--accent);
}
@keyframes shimmer { 0% { background-position: 0 0; } 100% { background-position: 240% 0; } }

/* ---------- Focus & Accessibility ---------- */
:focus-visible {
  outline: 2px solid transparent;
  box-shadow: 0 0 0 4px var(--ring);
  border-radius: 10px;
}
button:focus-visible, .input:focus-visible, .select:focus-visible { outline: none; }

/* Reduce motion */
@media (prefers-reduced-motion: reduce){
  * { animation: none !important; transition: none !important; }
}

/* ---------- Utility ---------- */
.grow { flex: 1; }
.hidden { display: none !important; }
